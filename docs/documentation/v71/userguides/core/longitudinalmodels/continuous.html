<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Longitudinal Models for Continuous Endpoints</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../../">
<link href="../../../../../media/FACTS_icon.png" rel="icon" type="image/png">
<script src="../../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link rel="preconnect" href="https://fonts.googleapis.com">

<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">



<!-- Roboto Serif -->

<link href="https://fonts.googleapis.com/css2?family=Roboto+Serif:wght@400;700&amp;display=swap" rel="stylesheet">



<!-- Roboto Sans -->

<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&amp;display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../../../styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../../../media/FACTSLogo.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../../introduction/index.html"> 
<span class="menu-text">Introduction</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../../../../../documentation/index.html" aria-current="page"> 
<span class="menu-text">Documentation</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../concepts/index.html"> 
<span class="menu-text">Concepts</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../../notes/index.html"> 
<span class="menu-text">Field Notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../versions/index.html"> 
<span class="menu-text">Versions</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../get/index.html"> 
<span class="menu-text">Get FACTS</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../contact/index.html"> 
<span class="menu-text">Contact</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Version 7.1</li><li class="breadcrumb-item"><a href="../../../../../documentation/v71/userguides/core/index.html">User Guides</a></li><li class="breadcrumb-item"><a href="../../../../../documentation/v71/userguides/core/index.html">FACTS Core Designs</a></li><li class="breadcrumb-item"><a href="../../../../../documentation/v71/userguides/core/design/index.html">Design Overview</a></li><li class="breadcrumb-item"><a href="../../../../../documentation/v71/userguides/core/longitudinalmodels/index.html">Longitudinal Models</a></li><li class="breadcrumb-item"><a href="../../../../../documentation/v71/userguides/core/longitudinalmodels/continuous.html">Continuous</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Documentation</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Version 7.1</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">User Guides</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../documentation/v71/userguides/core/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">FACTS Core Designs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth3 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Study</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth4 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/core/study/continuous.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Continuous</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/core/study/dichotomous.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dichotomous</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/core/study/tte.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Time-to-Event</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../documentation/v71/userguides/core/vsr/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Virtual Subject Response</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth4 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/core/vsr/continuous.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Continuous</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/core/vsr/dichotomous.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dichotomous</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/core/vsr/tte.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Time-to-Event</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/core/execution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Execution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/core/qois.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quantities of Interest (QOI) Tab</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../documentation/v71/userguides/core/design/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Design Overview</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth4 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/core/design/doseresponse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dose Response Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/core/design/frequentistanalysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Frequentist Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../documentation/v71/userguides/core/longitudinalmodels/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Longitudinal Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth5 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/core/longitudinalmodels/continuous.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Continuous</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/core/longitudinalmodels/dichotomous.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dichotomous</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/core/longitudinalmodels/tte.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Time-to-Event</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/core/design/allocation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Allocation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/core/design/interims.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interims</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/core/design/successfutility.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Success/Futility Criteria</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../documentation/v71/userguides/core/simulation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simulation</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth4 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/core/simulation/contanddichot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Continuous/Dichotomous</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/core/simulation/tte.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Time-to-Event</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/core/analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analysis</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/crm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">FACTS Dose Escalation CRM</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/FACTSfromR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Calling FACTS from R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/factsMenus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Standard FACTS Menus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/flfll.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">FACTS Linux File Loader Light - FLFLL</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/installation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">FACTS Installation Guide</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true">
 <span class="menu-text">Examples</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false">
 <span class="menu-text">CRM</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/examples/CRM/example1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Example 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/examples/CRM/example2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Example 2</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false">
 <span class="menu-text">Staged</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/examples/Staged/example1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Example 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/examples/Staged/example2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Example 2</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/glossary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Glossary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#locf-last-observation-carried-forward" id="toc-locf-last-observation-carried-forward" class="nav-link active" data-scroll-target="#locf-last-observation-carried-forward">LOCF (Last Observation Carried Forward)</a></li>
  <li><a href="#linear-regression" id="toc-linear-regression" class="nav-link" data-scroll-target="#linear-regression">Linear Regression</a></li>
  <li><a href="#time-course-hierarchical" id="toc-time-course-hierarchical" class="nav-link" data-scroll-target="#time-course-hierarchical">Time Course Hierarchical</a></li>
  <li><a href="#kernel-density" id="toc-kernel-density" class="nav-link" data-scroll-target="#kernel-density">Kernel Density</a></li>
  <li><a href="#itp" id="toc-itp" class="nav-link" data-scroll-target="#itp">ITP</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Version 7.1</li><li class="breadcrumb-item"><a href="../../../../../documentation/v71/userguides/core/index.html">User Guides</a></li><li class="breadcrumb-item"><a href="../../../../../documentation/v71/userguides/core/index.html">FACTS Core Designs</a></li><li class="breadcrumb-item"><a href="../../../../../documentation/v71/userguides/core/design/index.html">Design Overview</a></li><li class="breadcrumb-item"><a href="../../../../../documentation/v71/userguides/core/longitudinalmodels/index.html">Longitudinal Models</a></li><li class="breadcrumb-item"><a href="../../../../../documentation/v71/userguides/core/longitudinalmodels/continuous.html">Continuous</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Longitudinal Models for Continuous Endpoints</h1>
<p class="subtitle lead">Description of the longitudinal imputation models for continuous endpoints.</p>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header>


<section id="locf-last-observation-carried-forward" class="level1">
<h1>LOCF (Last Observation Carried Forward)</h1>
<p>The simplest possible longitudinal model. If {<span class="math inline">\(y_{it}\)</span>} is the set of observed responses from early visits, and <span class="math inline">\(y_{i t_m}\)</span> is the last observed value of <span class="math inline">\(y_{i t}\)</span>, then the LOCF model for the final endpoint <span class="math inline">\(Y_i\)</span> is</p>
<p><span class="math display">\[Y_i\mid \{y_{it}\} = y_{it_m}\]</span></p>
<p>In the continuous engine <span class="math inline">\(t_m\)</span> can be any earlier observed visit including the baseline value.</p>
</section>
<section id="linear-regression" class="level1">
<h1>Linear Regression</h1>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Shiny App
</div>
</div>
<div class="callout-body-container callout-body">
<p>The following shiny application for a tool that helps visualize and set priors for the linear regression longitudinal model.</p>
<p><a href="../../../../../concepts/facts/LinearRegressionLMPriors.html">See here.</a></p>
</div>
</div>
<p>The linear regression model fits a simple linear model from the data at each visit with the final visit</p>
<p><span class="math display">\[Y_i \mid y_{it} \sim \alpha_t + \beta_t y_{it} + \text{N}(0,\lambda_t^2)\]</span></p>
<p>The parameter <span class="math inline">\(\alpha_t\)</span> is the intercept of the model for visit t, and the parameter <span class="math inline">\(\beta_t\)</span> is a multiplicative modifier (slope) of the response observed longitudinal at visit <span class="math inline">\(t\)</span> to adjust the prediction of the final endpoint.</p>
<p>Imputation of the final endpoint value for a subject using the linear regression longitudinal model is based on only the latest observed visit’s endpoint value.</p>
<p>The default setting of “Same priors across all model instances and visits,” implies that each parameter <span class="math inline">\(\alpha\)</span>, <em>β</em>, and <em>λ</em> have the same prior for all <em>t</em>. Estimation of those parameters is still done independently for each model instance. The one prior across all model instance are formulated as:</p>
<p><span class="math display">\[\alpha_t \sim \text{N}(\alpha_\mu, \alpha_\sigma^2)\]</span> <span class="math display">\[\beta_t \sim \text{N}(\beta_\mu, \beta_\sigma^2)\]</span> <span class="math display">\[\lambda_{t}^{2} \sim \text{IG}\left( \frac{\lambda_{n}}{2},\frac{\lambda_{\mu}^{2}\lambda_{n}}{2} \right)\]</span></p>
<p>The above prior formulation may not be desirable if specifying priors that are not extremely diffuse – especially on the <span class="math inline">\(\beta\)</span> parameters. Instead, selecting “Specify priors per visit across all model instances,” will share the prior specification across all instances of the model, but allows for different priors to be put on the parameters associated with each visit. The user inputted prior parameters are now subscripted with <span class="math inline">\(t\)</span> to denote the visit they correspond to. These priors apply to all model instances:</p>
<p><span class="math display">\[\alpha_t \sim \text{N}(\alpha_{\mu_t}, \alpha_{\sigma_t}^2)\]</span> <span class="math display">\[\beta_t \sim \text{N}(\beta_{\mu_t}, \beta_{\sigma_t}^2)\]</span> <span class="math display">\[\lambda_{t}^{2} \sim \text{IG}\left( \frac{\lambda_{n_t}}{2},\frac{\lambda_{\mu_t}^{2}\lambda_{n_t}}{2} \right)\]</span></p>
<p>It is also possible to specify priors “Per model instance and visit,” in which every visit has separate priors, and those differing priors vary across model instances. This is the most flexible prior specification method. The user inputted prior parameters are now subscripted by both <em>t</em> for visit and <em>i</em> for model instance.</p>
<p><span class="math display">\[\alpha_{ti} \sim \text{N}(\alpha_{\mu_{ti}}, \alpha_{\sigma_{ti}}^2)\]</span> <span class="math display">\[\beta_{ti} \sim \text{N}(\beta_{\mu_{ti}}, \beta_{\sigma_{ti}}^2)\]</span> <span class="math display">\[\lambda_{ti}^{2} \sim \text{IG}\left( \frac{\lambda_{n_{ti}}}{2},\frac{\lambda_{\mu_{ti}}^{2}\lambda_{n_{ti}}}{2} \right)\]</span></p>
<p>A potential starting place for non-informative prior values would be</p>
<dl>
<dt><span class="math inline">\(\alpha\)</span></dt>
<dd>
mean of 0, SD <span class="math inline">\(\ge\)</span> largest expected response
</dd>
<dt><span class="math inline">\(\beta\)</span></dt>
<dd>
mean of either 0 or <span class="math inline">\(\frac{\text{final visit time}}{\text{early visit time}}\)</span>, SD <span class="math inline">\(\ge\)</span> largest expected ratio of final visit to first visit
</dd>
<dt><span class="math inline">\(\lambda\)</span></dt>
<dd>
mean of expected SD of the endpoint (‘sigma’), weight of 1. The variability of the prediction from the longitudinal model (based on an observed intermediate response) should be less than that based solely on the treatment allocation, thus this is a weakly pessimistic prior on the effectiveness of the longitudinal model that should be quickly overwhelmed by the data.
</dd>
</dl>
<p>This model is easy to understand and can be used even if there is only one visit, but doesn’t get more powerful if there are more visits. Its power will depend on the degree of correlation between the intermediate visit response and the final response.</p>
</section>
<section id="time-course-hierarchical" class="level1">
<h1>Time Course Hierarchical</h1>
<p>The Time Course Hierarchical models the relationship between subjects’ early responses and their final response. It incorporates a per-subject offset from the mean response and a scaling factor from each visit to the final endpoint, but with no model of the change from visit-to-visit.</p>
<p>The response at the <span class="math inline">\(t_{th}\)</span> visit for the <span class="math inline">\(i^{th}\)</span> subject, having been randomized to the <span class="math inline">\(d^{th}\)</span> dose is modeled as:</p>
<p><span class="math display">\[y_{it} \sim e^{\alpha_t}(\theta_d + \delta_i) + \text{N}(0, \lambda_t^2)\]</span></p>
<p>The imputed final response (visit <span class="math inline">\(T\)</span>$) for the <span class="math inline">\(i^{th}\)</span> subject, having been randomized to the <span class="math inline">\(d^{th}\)</span> dose is modeled as:</p>
<p><span class="math display">\[Y_{iT} \sim \theta_d + \delta_i + \text{N}(0, \lambda_T^2)\]</span></p>
<p>(i.e.&nbsp;<span class="math inline">\(\alpha_T\)</span> is 0).</p>
<p>The model parameters can be interpreted as follows:</p>
<dl>
<dt><span class="math inline">\(\theta_d\)</span></dt>
<dd>
the estimated mean response at the final visit in dose <span class="math inline">\(d\)</span> from the dose response model.
</dd>
<dt><span class="math inline">\(\delta_i\)</span></dt>
<dd>
the estimated patient level random effect around the mean final response (<span class="math inline">\(\theta_d\)</span>) for the dose <span class="math inline">\(d\)</span> that patient <span class="math inline">\(i\)</span> is randomized to.
</dd>
<dt><span class="math inline">\(\alpha_t\)</span></dt>
<dd>
a scaling parameter that determines the proportion of the final response that is observable at visit <span class="math inline">\(t\)</span>. A value of <span class="math inline">\(\alpha_t=0\)</span> indicates that the expected value of early visit <span class="math inline">\(t\)</span> is equal to the estimated final visit mean <span class="math inline">\(\theta_d\)</span>. A value of <span class="math inline">\(\alpha_t= −0.69315\)</span> indicates that the expected value of early visit <span class="math inline">\(t\)</span> is 50% of the estimated final visit mean <span class="math inline">\(\theta_d\)</span>.
</dd>
<dt><span class="math inline">\(\lambda_t^2\)</span></dt>
<dd>
the variance of the endpoint around the estimated mean response at visit <span class="math inline">\(t\)</span>.
</dd>
</dl>
<p>The prior for <span class="math inline">\(\alpha_t\)</span> is a normal distribution with a user specified the mean and standard deviation:</p>
<p><span class="math display">\[\alpha_t \sim \text{N}(\alpha_\mu, \alpha_\sigma^2)\]</span></p>
<p>The prior for the <span class="math inline">\(\delta_i\)</span> terms is a normal distribution with a mean of 0 and variance <em>τ</em><sup>2</sup>.</p>
<p><span class="math display">\[\delta_i \sim \text{N}(0, \tau^2)\]</span></p>
<p><span class="math inline">\(\tau^2\)</span> is estimated as part of the longitudinal model, and has an inverse gamma prior distribution with prior central value <span class="math inline">\(\tau_\mu\)</span> and weight (in terms of “equivalent number of observations”) <span class="math inline">\(\tau_n\)</span>:</p>
<p><span class="math display">\[\tau^{2} \sim \text{IG}\left( \frac{\tau_{n}}{2},\\\frac{\tau_{\mu}^{2}\tau_{n}}{2} \right)\]</span></p>
<p>The prior for the <span class="math inline">\(\lambda_t^2\)</span> terms is an inverse gamma distribution with prior central value <span class="math inline">\(\lambda_\mu\)</span> and weight (in terms of “equivalent number of observations”) <span class="math inline">\(\lambda_n\)</span>:</p>
<p><span class="math display">\[\lambda_{t}^{2}\sim\text{IG}\left( \frac{\lambda_{n}}{2},\frac{\lambda_{\mu}^{2}\lambda_{n}}{2} \right)\]</span></p>
<p>A reasonable starting place for prior values would be</p>
<dl>
<dt><span class="math inline">\(\alpha_t\)</span></dt>
<dd>
mean of -2, SD of 2, … so the prior ~70% interval for <span class="math inline">\(\alpha_t\)</span> is between -4 and 0 (+/1 1 SD) and thus the prior 70% interval for <span class="math inline">\(e^{\alpha_t}\)</span> to be between 0.02 and 1.
</dd>
<dt><span class="math inline">\(\tau\)</span></dt>
<dd>
mean set to the expected SD of the endpoint (‘sigma’), with a weight of 1.
</dd>
<dt><span class="math inline">\(\lambda_t\)</span></dt>
<dd>
mean set to the expected SD of the endpoint (‘sigma’), with weight of 1.
</dd>
</dl>
<p>We would expect <span class="math inline">\(\tau^2 + \lambda^2 \approx \sigma^2\)</span>, thus to specify a prior mean of <span class="math inline">\(\sigma\)</span> for each with a weight of 1 is a weakly pessimistic prior that should be quickly overwhelmed by the data.</p>
<p>This model is useful if there is thought to be a significant per-subject component to the response that should be manifest at the intermediate visits, and sufficient visits for the per-subject component to be estimated.</p>
</section>
<section id="kernel-density" class="level1">
<h1>Kernel Density</h1>
<p>The Kernel Density Model longitudinal model is a non-parametric re-sampling approach that is ideal for circumstances where the relationship between the interim time and the final endpoint is not known or not canonical.</p>
<p>The procedure is as follows. Assume an interim value for patient <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>, <span class="math inline">\(Y_{it}\)</span>. Patient <span class="math inline">\(i\)</span> does not have an observed final endpoint at time <span class="math inline">\(T\)</span>, so one is to be imputed. Let <span class="math inline">\((X_{1t},X_{1T}), \ldots, (X_{nt}, X_{nT})\)</span> be the set of values for the previous subjects for whom there exists an interim value <span class="math inline">\(X_{*t}\)</span> and final value <span class="math inline">\(X_{*T}\)</span>.</p>
<p>To impute a value of <span class="math inline">\(Y_{iT}\)</span> given <span class="math inline">\(Y_{it}\)</span>, a pair <span class="math inline">\((X_{kt},X_{kT})\)</span> is selected with probability based on the pair’s time <span class="math inline">\(t\)</span> visit response’s proximity to the observed <span class="math inline">\(Y_{it}\)</span>:</p>
<p><span class="math display">\[\Pr\left(\text{Selecting}\left( X_{kt},\\X_{kT} \right) \right) = \frac{\exp\left( - \frac{1}{2h_{X_{t}}^{2}}\left( Y_{it} - X_{kt} \right)^{2} \right)}{\sum_{k = 1}^{n}{\exp\left( - \frac{1}{2h_{X_{t}}^{2}}\left( Y_{it} - X_{kt} \right)^{2} \right)}}\]</span></p>
<p>Then, a value of <span class="math inline">\(Y_{iT}\)</span> is imputed from the following distribution, which uses the selected pair’s final endpoint response <span class="math inline">\(X_{kT}\)</span>:</p>
<p><span class="math display">\[Y_{iT} \sim \text{N}(X_{kT}, h_{X_T}^2)\]</span></p>
<p>The bandwidths <span class="math inline">\(h_{X_t}\)</span> and <span class="math inline">\(h_{X_T}\)</span> are selected based on the criterion given by Scott (1992). That is,</p>
<p><span class="math display">\[h_{X_{j}} = \sigma_{X_{j}} \left( 1 - \rho^{2} \right)^{\frac{5}{12}} \left( 1 + \frac{\rho^{2}}{2} \right)^{- \frac{1}{6}}{\\n}^{- \frac{1}{6}}\text{   for } j = t \text{ and } T\]</span></p>
<p>where <span class="math inline">\(\sigma_{X_j}\)</span> is the standard deviation of the observed responses at time <span class="math inline">\(j\)</span>, <span class="math inline">\(n\)</span> is the number of pairs <span class="math inline">\((X_{*t},X_{*T})\)</span> that were chosen between, and <span class="math inline">\(\rho\)</span> is the correlation coefficient between <span class="math inline">\(X_t\)</span> and <span class="math inline">\(X_T\)</span> in the pairs <span class="math inline">\((X_{1t},X_{1T}), \ldots, (X_{nt}, X_{nT})\)</span>.</p>
<p>The Kernel Density model does not take prior distributions as input. So long as each early visit has more subjects with an observed early response and final response than the value entered in “Minimum number of participants with an early visit and final visit needed to estimate kernel bandwidths for that early visit:” then this algorithm runs without regard for user input.</p>
<p>If any visit has fewer subjects with early data and final data than the specified minimum number of participants, then instead of calculating the values of <span class="math inline">\(h_{X_t}\)</span> or <span class="math inline">\(h_{X_T}\)</span> the input values of “Fixed kernel bandwidth <span class="math inline">\(h_x\)</span>:” and “Fixed kernel bandwidth <span class="math inline">\(h_y\)</span>:” are used.</p>
<p>For <span class="math inline">\(h_x\)</span> and <span class="math inline">\(h_y\)</span>, possible starting values are the expected SD of the endpoint (‘sigma’). The default value for the minimum number of subjects with complete early and final visits is 6, but this value can be set to anything greater than 0 that the user desires.</p>
<p>The Kernel Density model is effective and flexible with no model assumptions, but its computational overhead is large. Simulations may take <span class="math inline">\(\sim 10\)</span> times longer to run, and having no prior model there has to be ‘in trial’ data before it can come into play.</p>
</section>
<section id="itp" class="level1">
<h1>ITP</h1>
<p>The ITP (Integrated Two-component Prediction) model fits an observation for patient <span class="math inline">\(i\)</span> on dose <span class="math inline">\(d\)</span> at visit <span class="math inline">\(t\)</span> as:</p>
<p><span class="math display">\[y_{idt} = \left( \theta_{d} + s_{id} + \epsilon_{idt} \right)\left( \frac{1 - \text{exp}\left( kx_{idt} \right)}{1 - \text{exp}(kX)} \right)\]</span></p>
<p>where <span class="math display">\[\epsilon_{idt} \sim \text{N}(0, \lambda^2)\]</span> <span class="math display">\[s_{id} \sim \text{N}(0, \tau^2)\]</span></p>
<p>and <span class="math inline">\(\theta_d\)</span> is the mean estimate of the final endpoint for dose d using all complete and partial data and assuming an independent dose response model on the doses. <span class="math inline">\(s_{id}\)</span> is a subject specific random effect, <span class="math inline">\(k\)</span> is a shape parameter, <span class="math inline">\(x_{idt}\)</span> is the time <span class="math inline">\(y_{idt}\)</span> is observed, <span class="math inline">\(X\)</span> is the time to final endpoint, and each <span class="math inline">\(\epsilon_{idt}\)</span> is a residual error.</p>
<p>The ITP model is similar to the Time Course Hierarchical above in that both models estimate subject specific component of the response. The biggest difference between the two is that in the ITP models the response changes over time as a parametric function based on the parameter <span class="math inline">\(k\)</span>, rather than having a separately estimated <span class="math inline">\(e^{\alpha_t}\)</span> for each visit.</p>
<p>The shape parameter <span class="math inline">\(k\)</span> determines the rate at which the final endpoint’s eventual effect is observed during a subject’s follow-up. A value of <span class="math inline">\(k=0\)</span> indicates that the proportion of effect observed moves linearly with time. A value of <span class="math inline">\(k&lt;0\)</span> means that the eventual final effect is observed earlier in follow-up and plateaus off as time moves towards the final endpoint. A value of <span class="math inline">\(k&gt;0\)</span> indicates that less of the total final endpoint effect is observed early in follow up, but as time approaches the final endpoint time the proportion of the effect observed increases rapidly. Values of <span class="math inline">\(k\)</span> less than 0 tend to be more common than values of <span class="math inline">\(k\)</span> greater than 0. See the figure below for a visualization of the different response-over-time curves that can be estimated with the ITP model.</p>
<div id="fig-itpc" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-itpc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../coreUGattachments/CoreUserGuide/media/image39.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-itpc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Examples of a variety of ITP models with the shape parameter k ranging from -1 to 1.
</figcaption>
</figure>
</div>
<p>The priors for the parameters in the ITP model are: <span class="math display">\[k \sim \text{N}(\mu_k, \sigma_k^2)\]</span> <span class="math display">\[\theta_d \sim \text{N}(\mu_{\theta_d}, \sigma_{\theta_d}^2)\]</span> <span class="math display">\[\tau^2 \sim \text{IG}\left( \frac{\tau_{n}}{2},\frac{\tau_{\mu}^{2}\tau_{n}}{2} \right)\]</span> <span class="math display">\[\lambda^2 \sim \text{IG}\left( \frac{\lambda_{n}}{2},\frac{\lambda_{\mu}^{2}\lambda_{n}}{2} \right)\]</span></p>
<p>A reasonable starting place for prior values would be:</p>
<dl>
<dt><span class="math inline">\(\theta_d\)</span></dt>
<dd>
mean of the expected mean improvement from baseline on the Control arm, with SD greater than or equal to the expected treatment effect size.
</dd>
<dt><span class="math inline">\(k\)</span></dt>
<dd>
a mean of 0 and SD of 2, if subject improvement is expected to be rapid and then diminishing, the prior mean might be -0.5 or -1, if subject improvement is expected to be initially slow or non-existent then increasing, the prior mean might be 0.5 or 1.
</dd>
<dt><span class="math inline">\(\tau\)</span></dt>
<dd>
mean set to the expected SD of the endpoint (“sigma”), with a weight of 1.
</dd>
<dt><span class="math inline">\(\lambda\)</span></dt>
<dd>
mean set to the expected SD of the endpoint (“sigma”), with a weight of 1.
</dd>
</dl>
<p>The ITP model implies that the variance of the observations shrinks towards 0 with the mean (so early visits have reduced expected responses and variances). The ITP model may result in biased estimates of <span class="math inline">\(\theta_d\)</span> and/or the variance terms <span class="math inline">\(\tau^2\)</span> and <span class="math inline">\(\lambda^2\)</span> if the mean-variance relationship assumed by the ITP model is not present in the observed data. If the model assumptions are correct this can be a very effective longitudinal model.</p>


</section>

</main> <!-- /main -->
<!-- footer.html -->

<footer>

  <p>© <span id="year"></span> <a href="https://www.berryconsultants.com">Berry Consultants</a></p>

  <!-- <p>Made with <span style="color: #11A473;">❤</span> and <a href="https://quarto.org">Quarto</a></p> -->

</footer>



<script>

  document.getElementById('year').textContent = new Date().getFullYear();

</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>