<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Simulation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../../">
<link href="../../../../../media/FACTS_icon.png" rel="icon" type="image/png">
<script src="../../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link rel="preconnect" href="https://fonts.googleapis.com">

<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">



<!-- Roboto Serif -->

<link href="https://fonts.googleapis.com/css2?family=Roboto+Serif:wght@400;700&amp;display=swap" rel="stylesheet">



<!-- Roboto Sans -->

<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&amp;display=swap" rel="stylesheet">
<!-- Google tag (gtag.js) -->

<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-WLMVE7GR4S"></script>

<script>

  window.dataLayer = window.dataLayer || [];

  function gtag(){dataLayer.push(arguments);}

  gtag('js', new Date());



  gtag('config', 'G-WLMVE7GR4S');

</script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../../../styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../../../media/FACTSLogo.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../../introduction/index.html"> 
<span class="menu-text">Introduction</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../../../../../documentation/index.html" aria-current="page"> 
<span class="menu-text">Documentation</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../concepts/index.html"> 
<span class="menu-text">Concepts</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../../blog/index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../versions/index.html"> 
<span class="menu-text">Versions</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../get/index.html"> 
<span class="menu-text">Get FACTS</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../contact/index.html"> 
<span class="menu-text">Contact</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Version 7.1</li><li class="breadcrumb-item"><a href="../../../../../documentation/v71/userguides/core/index.html">User Guides</a></li><li class="breadcrumb-item"><a href="../../../../../documentation/v71/userguides/core/index.html">Phase II/III Designs</a></li><li class="breadcrumb-item"><a href="../../../../../documentation/v71/userguides/core/simulation/index.html">Simulation</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Documentation</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Version 7.1</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">User Guides</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../documentation/v71/userguides/core/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Phase II/III Designs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth3 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Study</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth4 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/core/study/continuous.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Continuous</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/core/study/dichotomous.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dichotomous</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/core/study/tte.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Time-to-Event</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../documentation/v71/userguides/core/vsr/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Virtual Subject Response</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth4 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/core/vsr/continuous.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Continuous</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/core/vsr/dichotomous.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dichotomous</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/core/vsr/tte.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Time-to-Event</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/core/execution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Execution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/core/qois.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quantities of Interest (QOI) Tab</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../documentation/v71/userguides/core/design/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Design</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth4 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/core/design/doseresponse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dose Response Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/core/design/frequentistanalysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Frequentist Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../documentation/v71/userguides/core/longitudinalmodels/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Longitudinal Models</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth5 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/core/longitudinalmodels/continuous.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Continuous</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/core/longitudinalmodels/dichotomous.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dichotomous</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/core/longitudinalmodels/tte.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Time-to-Event</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/core/design/allocation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Allocation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/core/design/interims.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interims</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/core/design/successfutility.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Success/Futility Criteria</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../documentation/v71/userguides/core/simulation/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Simulation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth4 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/core/simulation/contanddichot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Continuous/Dichotomous</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/core/simulation/tte.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Time-to-Event</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/core/analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analysis</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Platform Trials</span></span>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">CRM</span></span>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">3+3 / mTPI</span></span>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/crm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CRM</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/de.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3+3 / mTPI</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/FACTSfromR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Calling FACTS from R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/flfll.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">FLFLL</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/userguides/platform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Platform Trials</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="true">
 <span class="menu-text">Examples</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">CRM</span></span>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Staged</span></span>
  </li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/glossary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Glossary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../documentation/v71/references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#simulation-options" id="toc-simulation-options" class="nav-link active" data-scroll-target="#simulation-options">Simulation Options</a>
  <ul>
  <li><a href="#number-of-simulations" id="toc-number-of-simulations" class="nav-link" data-scroll-target="#number-of-simulations">Number of simulations</a></li>
  <li><a href="#start-at-simulation" id="toc-start-at-simulation" class="nav-link" data-scroll-target="#start-at-simulation">Start at Simulation</a></li>
  <li><a href="#parallelization-packet-size" id="toc-parallelization-packet-size" class="nav-link" data-scroll-target="#parallelization-packet-size">Parallelization Packet Size</a></li>
  <li><a href="#random-seed" id="toc-random-seed" class="nav-link" data-scroll-target="#random-seed">Random Seed</a></li>
  <li><a href="#mcmc-settings" id="toc-mcmc-settings" class="nav-link" data-scroll-target="#mcmc-settings">MCMC Settings</a></li>
  <li><a href="#results-output" id="toc-results-output" class="nav-link" data-scroll-target="#results-output">Results Output</a></li>
  </ul></li>
  <li><a href="#run-simulations" id="toc-run-simulations" class="nav-link" data-scroll-target="#run-simulations">Run Simulations</a>
  <ul>
  <li><a href="#facts-grid-simulation-settings" id="toc-facts-grid-simulation-settings" class="nav-link" data-scroll-target="#facts-grid-simulation-settings">FACTS Grid Simulation Settings</a></li>
  </ul></li>
  <li><a href="#simulation-results" id="toc-simulation-results" class="nav-link" data-scroll-target="#simulation-results">Simulation Results</a>
  <ul>
  <li><a href="#right-click-menu" id="toc-right-click-menu" class="nav-link" data-scroll-target="#right-click-menu">Right Click Menu</a></li>
  <li><a href="#open-in-r" id="toc-open-in-r" class="nav-link" data-scroll-target="#open-in-r">Open in R</a></li>
  <li><a href="#aggregation" id="toc-aggregation" class="nav-link" data-scroll-target="#aggregation">Aggregation</a></li>
  <li><a href="#design-report" id="toc-design-report" class="nav-link" data-scroll-target="#design-report">Design Report</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Version 7.1</li><li class="breadcrumb-item"><a href="../../../../../documentation/v71/userguides/core/index.html">User Guides</a></li><li class="breadcrumb-item"><a href="../../../../../documentation/v71/userguides/core/index.html">Phase II/III Designs</a></li><li class="breadcrumb-item"><a href="../../../../../documentation/v71/userguides/core/simulation/index.html">Simulation</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Simulation</h1>
<p class="subtitle lead">Description of the simulation tab and the results generated by simulations.</p>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header>


<p>The Simulation tab allows the user to execute simulations for each of the scenarios specified for the study. The user may choose the number of simulations, whether to execute locally or on the Grid, and modify the random number seeds.</p>
<div id="fig-simoutput" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-simoutput-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../coreUGattachments/continuous/media/image36.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-simoutput-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: The Simulation tab with complete simulation output in the table.
</figcaption>
</figure>
</div>
<p>In the Simulation tab the user can provide simulation configuration parameters like the number of simulations to run, whether the simulations can be run on the Grid, the parallelization strategy, the random number seed used in the simulations, and the number of certain output files that should be kept during the simulation execution.</p>
<section id="simulation-options" class="level1">
<h1>Simulation Options</h1>
<section id="number-of-simulations" class="level2">
<h2 class="anchored" data-anchor-id="number-of-simulations">Number of simulations</h2>
<p>This box allows the user to enter the number of simulations that they would like FACTS to run for each scenario listed in the table at the bottom of the simulation tab. There is no set number of simulations that is always appropriate.</p>
<dl>
<dt>10 simulations</dt>
<dd>
You might want to run 10 simulations if you just want to look at a few simulated trials and assess how the decision rules work and if FACTS is simulating what you expected based on what you input on the previous tabs. If all 10 simulations of a ‘null’ scenario are successful, or all 10 simulations of what was intended to be an effective drug scenario are futile, it is likely there has been a mistake or misunderstanding in the specification of the scenarios or the final evaluation or early stopping criteria.
</dd>
<dt>100 simulations</dt>
<dd>
You might want to run 100 simulations if you want to look at many individual trials to make sure that what you want to happen is nearly always happening. You can also start to get a very loose idea about operating characteristics like power based on 100 sims. 100 simulations is also usually sufficient to spot big problems with the data analysis such as poor model fits or significant bias in the posterior estimates.
</dd>
<dt>1,000 simulations</dt>
<dd>
You might want to run 1,000 simulations if you want estimates of operating characteristics like power, sample size, and Type I error for internal use or while iterating the design. This generally isn’t considered enough simulations for something like a regulatory submission. With 1,000 simulations the standard error for a typical type I error calculation is on the order of <span class="math inline">\(0.005\)</span>.
</dd>
<dt>10,000 simulations</dt>
<dd>
You might want to run 10,000 simulations per scenario if you are finalizing a design and are preparing a report. This is generally enough simulations for a regulatory submission, especially in non-null simulation scenarios. The standard error for a typical type I error calculation using 10,000 simulations is on the order of <span class="math inline">\(0.0015\)</span>.
</dd>
<dt>&gt; 10,000</dt>
<dd>
You might want to run more than 10,000 simulations if you want to be very certain of an operating characteristic’s value - like Type I error. And plan to use the measurement of the quantity for something important like a regulatory submission. The standard error of a Type I error calculation with 100,000 simulations, e.g., is on the order of <span class="math inline">\(0.0005\)</span>.
</dd>
<dt>&gt; 100,000</dt>
<dd>
You probably don’t want to run more than 100,000 simulations per scenario. Maybe your finger slipped an hit an extra 0, or you thought there were 5 zeroes in that number when there were actually 6. If the simulated trial is adaptive, this is going to take a while.
</dd>
</dl>
<p>Each time the FACTS application opens, the “Number of Simulations” will be set to the number of simulations last run for this design. Not all scenarios must be run with the same number of simulations. If completed results are available, the <em>actual</em> number of simulations run for each scenario is reported in the ‘Num Sims’ column of the results table. The value displayed in the “Number of Simulations” control is the number of simulations that <em>will be</em> run if the user clicks on the ‘Simulate’ button.</p>
<p>Note also that if a scenario uses an external VSR file or directory of external files, the number of simulations will be rounded down to the nearest complete multiple of the number of VSR lines or external files. If the number of simulations requested is less than the number of VSR lines or external files, then just the requested number of simulations are run.</p>
</section>
<section id="start-at-simulation" class="level2">
<h2 class="anchored" data-anchor-id="start-at-simulation">Start at Simulation</h2>
<p>The “Start at simulation” option allows for the simulation of a particular trial seen in a previous set of simulations without having to simulate all of the previous trials in that previous set to get to it.</p>
<p>The initial <a href="#random-seed">random seed</a> for FACTS simulations is set in the simulation tab. The first thing that FACTS does is to draw the random number seeds to use at the start of each simulation. Thus, it is possible to re-run a specific simulation out of a large set without re-running all of them. For example, say the 999<sup>th</sup> simulation out of a set displayed some unusual behavior, in order to understand why, one might want to see the individual interim analyses for that simulation (the “weeks” file), the sampled subject results for that simulation (the “Subjects” files) and possibly even the MCMC samples from the analyses in that simulation. You can save the .facts file with a slightly different name (to preserve the existing simulation results), then run 1 simulation of the specific scenario, specifying that the simulations start at simulation 999 and that at least 1 weeks file, 1 subjects file and the MCMC samples file (see the “MCMC settings” dialog) are output.</p>
</section>
<section id="parallelization-packet-size" class="level2">
<h2 class="anchored" data-anchor-id="parallelization-packet-size">Parallelization Packet Size</h2>
<p>The parallelization packet size option allows simulation jobs to be split into runs of no-more than the specified number of trials that are run in parallel. If more simulations of a scenario are requested than can be done in one packet, the simulations are broken into the requisite number of packets, run, and combined and summarized when they are all complete. The final results files will look just as though all the simulations were run as one job or packet.</p>
<p>The packet size must be a perfect divisor of the number of simulations. This is usually easy since common numbers of simulations are multiples of 100, but don’t try to use a prime number for Number of Simulations or you’re stuck with only 2 packet size options.</p>
<p>By default (if the check box with Choose Parallel Packet Size is not checked) the number of simulations per packet depends on the number of simulations per scenario. If the number of simulations is less than 1000, then each scenario is packaged as a single packed and simulated. If the number of simulations per scenario is greater than or equal to 1000, the default packet size is 10 and all simulations are decomposed into packets of size 10.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Packetization with VSRs using .mvsr files
</div>
</div>
<div class="callout-body-container callout-body">
<p>If an external file is used to create explicit VSRs (a .mvsr file), then the packet size should be a multiple of the number of rows in that MVSR file. Each packet will get passed the entire .mvsr file to run. If there are multiple .mvsr files with differing numbers of lines then only the VSR scenarios that have a .mvsr file that has a number of rows that is a divisor of the packet size will be run. The rest will error. The packet size can then be modified to get each of the .mvsr specified VSR files to be run.</p>
<p>Care should be taken when packetizing a scenario that includes an external data file to supply the virtual subject responses; in this situation, a of copy of the external file is included <em>in each packet</em> which can cause the packetisation process to run out of memory as the packets are being created. In this case, use a smaller number of larger packets, such as packets that are 1/10<sup>th</sup> of the total number of simulations.</p>
</div>
</div>
<p>When running simulations, FACTS will create and run as many packets in parallel as there are execution threads on the local machine. In general, the overhead of packetization is quite low, so a packet size of 10 to 100 can help speed up the overall simulation process. Threads used to simulate scenarios that finish quickly can pick up packets for scenarios that take longer. The progress bar updates as simulation packets complete, so the smaller the packet size, the more accurately FACTS can report the overall progress of the simulation execution.</p>
</section>
<section id="random-seed" class="level2">
<h2 class="anchored" data-anchor-id="random-seed">Random Seed</h2>
<p>Random number generation plays a huge role in FACTS’s virtual patient generation and statistical analyses. In order to exactly reproduce a statistical set of results, it is necessary to start the random number generation process from an identical “Random Seed”. Using the same random seed in the same version of FACTS guarantees that simulated trials will always be reproducible. Changing the design parameters or the version of FACTS may or may not remove this reproducibility depending on the change.</p>
<p>Even a small change in the random seed will produce very different simulation results.</p>
<p>In addition to setting the seed, the user can choose whether they want the “Same seed for all scenarios” or “Different seed” for different scenarios. If “Same seed for all scenarios” is selected, the subjects generated for each simulated trial will match for the different scenarios. This induces a correlation among the simulation output for different scenarios. This can be good if you’re trying to compare operating characteristics for different scenarios, but it can also be misleading. To disable this option select the “Different Seed” option. If “Different seed” is selected, then each scenario has its own seed that samples a different set of subjects than any other scenario. This uncorrelates the simulation output across scenarios, which can be advantageous if the absolute value of the operating characteristics are more valuable to you than the comparison of operating characteristics across scenarios.</p>
</section>
<section id="mcmc-settings" class="level2">
<h2 class="anchored" data-anchor-id="mcmc-settings">MCMC Settings</h2>
<p>To set advanced settings for simulation, the user may click the “MCMC Settings” button, which will display a number of additional specifiable parameters for simulation in a separate window.</p>
<div id="fig-mcmcsettings" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mcmcsettings-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../coreUGattachments/continuous/media/image37.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mcmcsettings-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Advanced MCMC settings.
</figcaption>
</figure>
</div>
<p>The first two values specify two standard MCMC parameters –</p>
<ul>
<li><p>The length of burn-in is the number of the initial iterations whose results are discarded, to allow the MCMC chain to reach its stationary distribution. Burn-in samples are output in MCMC files if the files are output.</p></li>
<li><p>The number of samples is the number of subsequent iterations whose results are recorded in order to give posterior estimates of the values of interest.</p></li>
</ul>
<p>The third parameter controls the number of MCMC samples taken after each imputation of missing data using the longitudinal model. The default value is 1. This parameter only has an effect if Bayesian imputation is being used to impute missing or partially observed data. Increasing the value of this parameter allows the parameter estimates to converge somewhat to a potentially new stationary distribution for each new set of imputed data. If the imputed data is only a small percentage of the overall data this is likely unnecessary. As a rough guide, if it at some early interims &gt; 5% of the data being analyzed will be imputed, a value in the range 2 to 10 is recommended to avoid underestimating the uncertainty. A higher number should be used the greater the proportion of imputed data.</p>
<p>The next parameter concerns the output of the MCMC samples to a file. It is possible to have the design engine output the sampled values from the MCMC in all of the interims of the first N simulated trials of each scenario by specifying the “Number of MCMC files to output” to be greater than 0. The resulting files, ‘mcmcNNNN.csv’, will be in the results directory with all the other results files for that scenario. These files include the burn-in samples from the MCMC chains.</p>
<p>The final parameter in MCMC Settings is the thinning parameter. This parameter will only keep every <span class="math inline">\(N^{th}\)</span> sample taken during MCMC where <span class="math inline">\(N\)</span> is the thinning parameter. Thinning MCMC samples can reduce the autocorrelation of consecutive MCMC iterations, which increases the effective samples per retained sample, but also results in needing many more MCMC iterations to reach the same number of retained samples. Generally, we do not recommend thinning for standard simulation runs.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning about thinning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Unlike other software that performs MCMC, when you choose to thin by a value, FACTS does not increase the number of MCMC iterations it performs in order to retain the value specified in “Number of Samples”. So if you leave “Number of Samples” at its default value, <span class="math inline">\(2500\)</span>, and thin by <span class="math inline">\(10\)</span>, you will be left with <span class="math inline">\(250\)</span> retained samples. You should adjust for this by increasing the “Number of Samples” if you choose to thin.</p>
</div>
</div>
</section>
<section id="results-output" class="level2">
<h2 class="anchored" data-anchor-id="results-output">Results Output</h2>
<p>The results output section of the Simulation tab allows for the specification of how many output files should be generated for files that are individually created for each simulation. Summary files (summary.csv) that have 1 line per scenario are always created. Simulations files (simulations.csv) that have 1 line per simulation are always created. Weeks files (weeksXXXXX.csv), patients files (patientsXXXXX.csv), and frequentist weeks files (weeks_freq_{missingness}_XXXXX.csv) are not created for every single simulation. Instead, the number of simulation specific output files can be set per type. This limits the amount of output files that FACTS will save.</p>
<p>See the endpoint specific descriptions of the output files for descriptions of what the previously mentioned output files report. See <a href="../../../../../documentation/v71/userguides/core/simulation/contanddichot.html">here</a> for core continuous or dichotomous output files, and see <a href="../../../../../documentation/v71/userguides/core/simulation/tte.html">here</a> for core time-to-event output files.</p>
<p>Some plots in FACTS that are created based on weeks files, and if very few weeks files are saved, the plots will not be as accurate or descriptive.</p>
</section>
</section>
<section id="run-simulations" class="level1">
<h1>Run Simulations</h1>
<p>Click in the check box in each of the rows corresponding the to the scenarios to be run. FACTS displays a row for each possible combination of the ‘profiles’ that have been specified: - baseline response, dose response, longitudinal response, accrual rate, and dropout rate. Or simply click on “Select All”.</p>
<p>Then click on the “Simulate” button.</p>
<p>During simulation, the user is prevented from modifying any parameters on any other tab of the application. This safeguard ensures that the simulation results reflect the parameters specified in the user interface.</p>
<p>When simulations are started, FACTS saves all the study parameters, and when the simulations are complete all the simulation results are saved in results files in a “_results” folder in the same directory as the “.facts” file. Within the “_results” folder there will be a sub-folder that holds the results for each scenario.</p>
<section id="facts-grid-simulation-settings" class="level2">
<h2 class="anchored" data-anchor-id="facts-grid-simulation-settings">FACTS Grid Simulation Settings</h2>
<p>A user with access to a computational grid may choose to run simulations on the grid instead of running them locally. This frees the user’s computer from the computationally intensive task of simulating so that they can continue other work or even shutdown their PC or laptop. In order to run simulations on the grid, it must first be configured. This is normally done via a configuration file supplied with the FACTS installation by the IT group responsible for the FACTS installation.</p>
</section>
</section>
<section id="simulation-results" class="level1">
<h1>Simulation Results</h1>
<p>In the center of the simulation tab, the summary simulation results are displayed. There are many columns of results, these are organized into related groups of sub-windows, which can be displayed by clicking on the “Show More Columns” button.</p>
<div id="fig-showmorecolumns" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-showmorecolumns-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../coreUGattachments/continuous/media/image38.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-showmorecolumns-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Options available when clicking on the “Show More Columns…” button.
</figcaption>
</figure>
</div>
<p>These windows will show:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 27%">
<col style="width: 72%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Column Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>All</td>
<td>All summary columns</td>
</tr>
<tr class="even">
<td>Highlights</td>
<td>Only the columns shown on the main tab</td>
</tr>
<tr class="odd">
<td>Allocation</td>
<td>The columns that report on participant recruitment and allocation</td>
</tr>
<tr class="even">
<td>Response</td>
<td>The columns that report that estimate treatment response, the SD of the estimate, the estimate of the SD of the response, the true treatment response and the true SD of the response.</td>
</tr>
<tr class="odd">
<td>Observed</td>
<td>The raw endpoint output and the dropout rates by arm and visit</td>
</tr>
<tr class="even">
<td>Probabilities</td>
<td>The final estimates for the QOIs that were computed for the trial.</td>
</tr>
<tr class="odd">
<td>Stopping Rules</td>
<td>The proportion of times the different stopping criteria were met</td>
</tr>
<tr class="even">
<td>Model Parameters</td>
<td>The columns that report the estimates of the values of the model parameters.</td>
</tr>
<tr class="odd">
<td>Simulation Results</td>
<td>A window that displays the individual simulation results for the currently selected scenario.</td>
</tr>
<tr class="even">
<td>Simulation Duration</td>
<td>A window that displays how long each scenario took to simulate</td>
</tr>
<tr class="odd">
<td>Frequentist results</td>
<td>If frequentist analysis is enabled, the summary results can be viewed, these are grouped by how missing data has been treated: Last Observation Carried Forward (LOCF), Baseline Observation Carried Forward (BOCF – if baseline has been simulated), Per-Protocol (PP).</td>
</tr>
</tbody>
</table>
<section id="right-click-menu" class="level2">
<h2 class="anchored" data-anchor-id="right-click-menu">Right Click Menu</h2>
<p>Clicking the Right-hand mouse button on a row in the simulations tab brings up a short cut menu:</p>
<div id="fig-simrightclick" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-simrightclick-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../coreUGattachments/continuous/media/image39.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-simrightclick-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: The menu that appears when you right click on the table within the simulation tab.
</figcaption>
</figure>
</div>
<p>These will respectively:</p>
<ul>
<li><p>Open a new Windows directory browser window showing the contents of the simulation results for that scenario.</p></li>
<li><p>Open a window that displays the individual simulation results for that scenario. The results initially displayed are the ‘highlights’ columns, similarly to the summary results (see below) the results columns are collected into sub-groups, windows of these subgroups can be opened from the Right Click menu of the Simulation Results highlights window.</p></li>
<li><p>Open a window that displays the frequentist analysis summary results. This option is only available if one or more frequentist analyses have been selected on the Design &gt; Frequentist Analysis tab. (If more than one analysis has been requested – using different treatments of missing data there will be separate options in the menu to display each summary).</p></li>
<li><p>Open R loading in the result files for that scenario as separate dataframes.</p></li>
<li><p>Opens the FACTS graph control displaying the graphs for that scenario.</p></li>
<li><p>Opens the FACTS graph control that displays the trellis plot of graphs of selected scenarios for selected design variants.</p></li>
</ul>
</section>
<section id="open-in-r" class="level2">
<h2 class="anchored" data-anchor-id="open-in-r">Open in R</h2>
<p>The “Open in R” button allows for the creation of an R script that has pre-populated code for loading in output files created by the FACTS simulations.</p>
<p>By default, any/all of the simulation output files can be included in the created script. If “Aggregation” (see below) has been performed, then only the aggregated files will be available for being loaded in R.</p>
<p>When the button is clicked, FACTS will create an R script with the correct file paths to load in the data, as well as creating a function that will read the files in correctly. The file is then opened in the default R editor for the user. If there is no default program for opening a .R file, your operating system should ask how you want to open the file.</p>
</section>
<section id="aggregation" class="level2">
<h2 class="anchored" data-anchor-id="aggregation">Aggregation</h2>
<p>Aggregation combines the csv output from multiple scenarios into fewer csv files. The Aggregate… button displays a dialog which allows the user to select what to aggregate.</p>
<div id="fig-aggregate" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-aggregate-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../coreUGattachments/continuous/media/image40.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-aggregate-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Window that appears when aggregating simulation results.
</figcaption>
</figure>
</div>
<p>The default location for the aggregated files is the results directory for the study, but this can be changed.</p>
<p>Aggregation may be performed with or without pivoting on group, or both.</p>
<ul>
<li><p>Unpivoted files will have one row for each row in the original files.</p></li>
<li><p>In pivoted files each original row will be split into one row per dose.</p>
<ul>
<li><p>Where there is a group of columns for each dose, they will be turned into a single column with each value on a new row.</p></li>
<li><p>Values in columns that are independent of dose will be repeated on each row.</p></li>
</ul></li>
</ul>
<p>The default is to aggregate all scenarios, but any combination may be selected.</p>
<p>Pressing “Aggregate” generates the aggregated files.</p>
<p>Each type of csv file is aggregated into a separate csv file whose name begins agg_ or agg_pivot_, so agg_summary.csv will contain the rows from each of the summary.csv files, unpivoted. WeeksNNNNN.csv files are aggregated into a single agg_[pivot_]weeks.csv file. PatientsNNNNN.csv files are aggregated into a single agg_patients.csv file, but they are never pivoted because each row already refers to a single dose. Similarly the various frequentist results at the summary, simulation and weeks level are aggregated (if they’ve been output).</p>
<p>RegionIndex.csv is not aggregated.</p>
<p>Each aggregated file begins with the following extra columns, followed by the columns from the original csv file:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 28%">
<col style="width: 68%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Column Name</th>
<th style="text-align: left;">Comments</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Scenario ID</td>
<td style="text-align: left;">Index of the scenario</td>
</tr>
<tr class="even">
<td style="text-align: left;">Recruitment Profile</td>
<td style="text-align: left;">A series of columns containing the names of the various profiles used to construct the scenario. Columns that are never used are omitted (e.g. External Subjects Profile if there are no external scenarios)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dropouts Profile</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Longitudinal Rates Profile</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dose Response Profile</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">External Subjects Profile</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Agg Timestamp</td>
<td style="text-align: left;">Date and time when aggregation was performed</td>
</tr>
<tr class="even">
<td style="text-align: left;">P(TS)</td>
<td style="text-align: left;">Proportion of trial success (early success + late success)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">P(TF)</td>
<td style="text-align: left;">Proportion of trial futility (early futility + late futility)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sim</td>
<td style="text-align: left;">Simulation number. Only present in weeks and patients files.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dose</td>
<td style="text-align: left;">Only present if pivoted</td>
</tr>
</tbody>
</table>
</section>
<section id="design-report" class="level2">
<h2 class="anchored" data-anchor-id="design-report">Design Report</h2>
<p>This button becomes enabled once there are simulation results, it uses an R script and R libraries to generate a MS Word document describing the design.</p>
<p>See the <a href="./designReport.qmd">FACTS Design Report User Guide</a> for details of what R packages need installing, how FACTS needs configuring to use the correct R instance, how the generate_report() function is run, and where the resulting report can be found.</p>
<!--
# Trial States

## State descriptions

For the purposes of interims, the different states or stages of a trial
are:

1.  **In Burn-in / before first analysis.** In adaptive allocation
    designs, the burn-in denotes the initial group of subjects
    explicitly assigned to treatment arms before probabilistic
    allocation begins. FACTS prevents the burn-in requiring more
    subjects than the maximum number of subjects – but the numbers can
    be equal. Regardless of the interim schedule specified (e.g.,
    frequency, number of subjects or number of events), a) no analyses
    are performed during this period of time, and b) the first analysis
    is performed at its conclusion. In arm dropping and early stopping
    designs the first analysis occurs at the explicitly specified
    initial interim. Interims are never performed in non-adaptive
    designs; rather, the first and only analysis occurs when the max
    subject’s final observation is taken. In all cases, it is possible
    to reach the maximum number of events prior to the first analysis,
    making the study complete.

2.  **Mid Trial**. Interims are performed and all rules assessed. If
    arms have been dropped, the per-arm posterior probabilities are
    still calculated for the dropped arms but the drop decision for the
    arms is absorbing and not re-assessed.

3.  **Fully Accrued but not complete**. All subjects have been recruited
    and being followed up. If interims are by subject or ‘interim
    analysis beyond full accrual’ is set to FALSE, then the only
    possible next event is ‘last subject final observation’.

4.  **Stopped Early but still following up.** The study stopping rules
    are not evaluated, but arm dropping rules are. Interims may still
    occur.

5.  **Complete.** All possible data collected for every enrolled
    subject.

## Analysis trigger events

The following are the events that trigger interims, stopping or changes
of trial state:

1.  Last event is observed (TTE trial with a max number of events – this
    is the only circumstance that can arise before the end of burn-in /
    first analysis that can stop the trial).

2.  A “number of subjects interim” occurs (other than last subject of
    burn-in / first analysis)

3.  A “cohort complete” interim occurs (when using cohort enrolment). A
    cohort complete event is slightly different from a “number of
    subjects interim” in that after a cohort is fully enrolled the
    interim does not occur until all the subjects are complete.

4.  Study max subject size is reached.

5.  Recruit last subject of burn-in / first analysis occurs.

6.  A “time” or “number of events” interim occurs.

7.  Last subject’s final observation is taken (in a TTE trial this might
    be that the last subject to have an event has their event, or last
    subject recruited reaches the end of the maximum follow-up and is
    censored).

## Trial State Transitions

Note: the term “study arms” is used to refer to the treatment arms that
are not the control or active comparator arm. In an arm dropping design
only the study arms can be dropped, and the trial stops if all study
arms are dropped.

<style>
 .table_wrapper{
    /* display: block; */
    overflow-x: auto;
    /* white-space: nowrap; */
    /* min-width: 1000px; */
    width: 100%;
}
</style>

<div class="table_wrapper" >

<table class="caption-top" style="width:100%;" data-quarto-postprocess="true">
<caption>Figure 3‑2 Add Posterior Probability QOI dialog</caption>
<colgroup>
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 16%" />
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th colspan="5" data-quarto-table-cell-role="th">State transition table</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>Triggers</p>
<p><span style="white-space: nowrap;">Processed in order…</span></p></td>
<td><p><strong><span style="white-space: nowrap;">1: In Burn-in / before</span> first analysis</strong></p>
<p>[This is the starting state for adaptive allocation designs]</p></td>
<td><p><strong>2: Mid Trial</strong></p>
<p><span style="white-space: nowrap;">[This is the starting state</span> for arm dropping, early stopping, and non-adaptive designs]</p></td>
<td><p><strong><span style="white-space: nowrap;">3: Fully Accrued but not</span> complete</strong></p></td>
<td><p><strong><span style="white-space: nowrap;">4: Stopped Early but following</span> up</strong></p>
<p>[This state can only be entered if “Continue follow-up if study stopped for success/futility is set]</p></td>
<td><p><strong><span style="white-space: nowrap;">5: Complete</span></strong></p>
<p>[This is the final state]</p></td>
</tr>
<tr class="even">
<td>A: Last event is observed [can only occur in TTE trials]</td>
<td><p>A “final evaluation” is output.</p>
<p>Go to “5: Complete”</p></td>
<td><p>A “final evaluation” is output.</p>
<p>Go to “5: Complete”</p></td>
<td><p>A “final evaluation” is output.</p>
<p>Go to “5: Complete”</p></td>
<td><p>A “final evaluation” is output.</p>
<p>Go to “5: Complete”</p></td>
<td>N/A</td>
</tr>
<tr class="odd">
<td>B: A “number of subjects” interim occurs</td>
<td>N/A</td>
<td><p>An interim is output.</p>
<p>If arm dropping, check not yet dropped arms to see if any should be dropped and flag those that are.</p>
<p>If stopping conditions are met or all study arms dropped then if “Continue follow-up” for the appropriate decision is selected go to “4: Stopped Early” otherwise a “final evaluation” is output and</p>
<p>Go to “5: Complete”</p>
<p>If the interim size = Max subjects then go to “3: Fully Accrued”</p>
<p>Otherwise stay in “2: Mid Trial”</p></td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="even">
<td>C: A “cohort complete” interim occurs [for trials using cohort enrolment]</td>
<td><p>[Can only occur when the final observation of a burn-in cohort is observed]</p>
<p>An interim is output.</p>
<p>If stopping conditions are met a “final evaluation” is output and go to “5: Complete”.</p>
<p>Otherwise go to “2: Mid Trial”.</p></td>
<td><p>An interim is output.</p>
<p>If stopping conditions are met a “final evaluation” is output and go to “5: Complete”.</p>
<p>If the interim size = Max cohort or the max cohort size is reached then a “final evaluation” is output and go to “5: Complete”.</p>
<p>Otherwise stay in “2: Mid Trial”</p></td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="odd">
<td>D: Study max subject size is reached</td>
<td><p>[Can only occur if Burn-in / first interim size = Max subjects]</p>
<p>Go to “3: Fully Accrued”.</p></td>
<td>Go to “3: Fully Accrued”</td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="even">
<td>E: Recruit last subject of burn-in / first analysis</td>
<td><p>An interim is output.</p>
<p>If arm dropping, check not yet dropped arms to see if any should be dropped and flag those that are.</p>
<p>If stopping conditions are met or all study arms dropped then ff “Continue Follow-up if study stopped“ for the appropriate decision is set go to “4: Stopped Early but following up” otherwise a “final evaluation” is output and go to “5: Complete”</p>
<p>Otherwise go to “2: Mid Trial”</p></td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="odd">
<td>F: A “time” or “number of events” interim occurs</td>
<td>N/A</td>
<td><p>An interim is output.</p>
<p>If arm dropping, check not yet dropped arms to see if any should be dropped and flag those that are.</p>
<p>If stopping conditions are met or all study arms dropped then ff “Continue Follow-up if study stopped“ for the appropriate decision is set go to “4: Stopped Early but following up” otherwise a “final evaluation” is output and go to “5: Complete”</p>
<p>Otherwise stay in “2: Mid Trial”</p></td>
<td><p>If “Discontinue interim analysis after full enrollment” is set, then there is no output. Stay in “3: Fully Accrued”</p>
<p>Otherwise:</p>
<p>An interim is output.</p>
<p>If arm dropping, check not yet dropped arms to see if any should be dropped and flag those that are.</p>
<p>If stopping conditions are met or all study arms dropped then ff “Continue Follow-up if study stopped“ for the appropriate decision is set go to “4: Stopped Early but following up” otherwise a “final evaluation” is output and go to “5: Complete”</p>
<p>Otherwise stay in “3: Fully Accrued”</p></td>
<td><p>If “Discontinue interim analysis after full enrollment” is set then there is no output, stay in “4: Stopped Early”</p>
<p>Otherwise:</p>
<p>An interim only checking arm-dropping is output. Stopping conditions not checked.</p>
<p>If arm dropping, check not yet dropped arms to see if any should be dropped and flag those that are.</p>
<p>If all study arms are dropped then if “Continue follow-up if arm dropped” is set stay in “4: Stopped Early” otherwise a “final evaluation” is output and go to “5: Complete”</p></td>
<td>N/A</td>
</tr>
<tr class="even">
<td>G: Last subject’s final observation is taken</td>
<td>N/A</td>
<td>N/A</td>
<td><p>A “final evaluation” is output.</p>
<p>Go to “5: Complete”</p></td>
<td><p>A “final evaluation” is output.</p>
<p>Go to “5: Complete”</p></td>
<td>N/A</td>
</tr>
</tbody>
</table>

</div> -->


</section>
</section>

</main> <!-- /main -->
<footer style="display: flex; justify-content: space-between; align-items: center;">

  <!-- Left side: Copyright -->

  <p style="margin: 0;">

    © <span id="year"></span>

    <a href="https://www.berryconsultants.com">Berry Consultants</a>

  </p>



  <!-- Right side: Relative link -->

  <p style="margin: 0;">

    <a href="../../../../../introduction/citation.html">How to Cite</a>

  </p>

</footer>



<script>

  document.getElementById('year').textContent = new Date().getFullYear();

</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>